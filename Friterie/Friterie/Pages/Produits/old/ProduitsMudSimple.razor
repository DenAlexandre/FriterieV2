@page "/produit52542"
@using MudBlazor
@inject ISnackbar Snackbar

<h3 class="mb-4">📦 Liste des produits</h3>

<!-- Barre de recherche pour filtrer -->
<MudTextField @bind-Value="searchString" Placeholder="🔍 Rechercher..."
              Adornment="Adornment.Start" AdornmentIcon="@Icons.Material.Filled.Search"
              Class="mb-3" />

<MudTable Class="mud-table-bordered" Items="Produits" Filter="FilterFunc" Hover="true" Bordered="true" Striped="true" Dense="true" SortLabel="Trier par">

    <!-- En-têtes -->
    <HeaderContent>
        <MudTh>Nom</MudTh>
        <MudTh>Catégorie</MudTh>
        <MudTh>Prix (€)</MudTh>
    </HeaderContent>

    <!-- Lignes -->
    <RowTemplate>
        <MudTd DataLabel="Nom">@context.Nom</MudTd>
        <MudTd DataLabel="Catégorie">@context.Categorie</MudTd>
        <MudTd DataLabel="Prix">@context.Prix.ToString("C")</MudTd>
    </RowTemplate>

    <!-- Pagination -->
    <PagerContent>
        <MudTablePager />
    </PagerContent>

</MudTable>

@code {
    private string searchString = "";

    private List<Produit> Produits = new()
    {
        new Produit{ Nom="Pomme", Categorie="Fruit", Prix=1.20m },
        new Produit{ Nom="Banane", Categorie="Fruit", Prix=0.80m },
        new Produit{ Nom="Tomate", Categorie="Légume", Prix=2.50m },
        new Produit{ Nom="Carotte", Categorie="Légume", Prix=1.00m },
        new Produit{ Nom="Steak", Categorie="Viande", Prix=8.90m },
        new Produit{ Nom="Poulet", Categorie="Viande", Prix=6.50m },
        new Produit{ Nom="Orange", Categorie="Fruit", Prix=1.10m },
        new Produit{ Nom="Courgette", Categorie="Légume", Prix=2.00m }
    };

    private bool FilterFunc(Produit produit)
    {
        if (string.IsNullOrWhiteSpace(searchString))
            return true;

        return produit.Nom.Contains(searchString, StringComparison.OrdinalIgnoreCase)
            || produit.Categorie.Contains(searchString, StringComparison.OrdinalIgnoreCase)
            || produit.Prix.ToString().Contains(searchString, StringComparison.OrdinalIgnoreCase);
    }

    public class Produit
    {
        public string Nom { get; set; } = "";
        public string Categorie { get; set; } = "";
        public decimal Prix { get; set; }
    }
}
